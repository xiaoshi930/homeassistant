水暖毯:
  triggers_update:
    - '[[[ return variables.水暖毯 ]]]'
    - '[[[ return variables.附加信息 ]]]'
    - '[[[ return variables.防冻 ]]]' 
    - '[[[ return variables.防烫伤 ]]]' 
    - '[[[ return variables.睡眠 ]]]' 
    - '[[[ return variables.指示灯 ]]]' 
    - '[[[ return variables.提示音 ]]]' 
    - '[[[ return variables.按键锁 ]]]' 
    - '[[[ return variables.水位提示 ]]]' 
  styles:
    grid:
      - grid-template-areas: |
          [[[
             if (variables.附加信息=='左侧')  return '"mo b b  b  b  b  b  b  b"' +
                                                    '"mo y a0 a0 a0 a0 a0 a0 x"' +
                                                    '"mo y i2 i2 i2 i2 i2 i2 x"' +
                                                    '"mo y i3 i3 i3 i3 i3 i3 x"' +
                                                    '"mo y i4 i4 i4 i4 i4 i4 x"' +
                                                    '"mo y z5 m  m  p  p  z6 x"' +
                                                    '"mo y a1 a1 a1 a2 a2 a2 x"' +
                                                    '"mo y a3 a3 a3 a4 a4 a4 x"' ;
             if (variables.附加信息=='右侧')  return '"b b  b  b  b  b  b  b mo"' +
                                                    '"y a0 a0 a0 a0 a0 a0 x mo"' +
                                                    '"y i2 i2 i2 i2 i2 i2 x mo"' +
                                                    '"y i3 i3 i3 i3 i3 i3 x mo"' +
                                                    '"y i4 i4 i4 i4 i4 i4 x mo"' +
                                                    '"y z5 m  m  p  p  z6 x mo"' +
                                                    '"y a1 a1 a1 a2 a2 a2 x mo"' +
                                                    '"y a3 a3 a3 a4 a4 a4 x mo"' ;
             else return  '"b b  b  b  b  b  b  b"' +
                          '"y a0 a0 a0 a0 a0 a0 x"' +
                          '"y i2 i2 i2 i2 i2 i2 x"' +
                          '"y i3 i3 i3 i3 i3 i3 x"' +
                          '"y i4 i4 i4 i4 i4 i4 x"' +
                          '"y z5 m  m  p  p  z6 x"' +
                          '"y a1 a1 a1 a2 a2 a2 x"' +
                          '"y a3 a3 a3 a4 a4 a4 x"' ;
          ]]]
      - grid-template-columns: |
          [[[
             if (variables.附加信息=='左侧')  return "67px 18px 44px 44px 44px 44px 44px 44px 18px";
             if (variables.附加信息=='右侧')  return "18px 44px 44px 44px 44px 44px 44px 25px 67px";
             else  return "18px 44px 44px 44px 44px 44px 44px 18px";
          ]]]
      - grid-template-rows: 0px 340px 0px 0px 0px 0px 0px 0px 0px 0px
    card:
      - padding: 0
      - width: |
          [[[
              if (variables.附加信息=='左侧' || variables.附加信息=='右侧') return "370px";
              return "300px";
          ]]]
      - height: 455px
      - border-width: 0
      - background: transparent
  custom_fields:
    b:
      card:
        type: custom:button-card
        styles:
          card:
            - margin-top: 455px
            - width: 300px
            - height: 455px
            - border-radius: 15px
            - border-width: 0
            - background: '[[[ return variables.主题 =="on" ? "rgb(255,255,255)" : "rgb(50,50,50)" ]]]'
    i2:
      card:
        type: custom:button-card
        styles: 
          card: 
            - margin-top: -272px
            - border-width: 0
            - background: |
                [[[ 
                    var state = states[variables.水暖毯].state;
                    if(state=='heat' ) return "radial-gradient(rgb(255,69,0) -20%, transparent 50%)" ;
                    return "transparent" ;
                ]]]
            - width: 264px
            - height: 264px
    a0:
      card: 
        type: thermostat
        entity: '[[[ return  variables.水暖毯 ]]]'
        card_mod:
          style: |
            [[[ 
                const label_on = `
                  ha-card{ 
                    background: rgb(0,0,0,0); 
                    border-width: 0;
                    color: rgb(0,0,0);
                    --disabled-color: rgb(120,120,120);
                  }
                `;   
                const label_off = ` 
                  ha-card{ 
                    background: rgb(0,0,0,0);
                    border-width: 0;
                    color: rgb(255,255,255);
                    --disabled-color: rgb(220,220,220);
                  }
                `; 
                return variables.主题 =="on"  ? label_on : label_off; 
            ]]]
    i3:
      card:
        type: custom:button-card
        styles:
          card:
            - margin-top: 40px
            - width: 264px
            - height: 42px
            - border-width: 0
            - background: '[[[ return variables.主题 =="on" ? "rgb(230,230,230)" : "rgb(80,80,80)" ]]]'
            - border-radius: 10px
    i4:
      card:
        type: custom:button-card
        styles:
          card:
            - margin-top: 150px
            - width: 264px
            - height: 42px
            - border-width: 0
            - background: '[[[ return variables.主题 =="on" ? "rgb(230,230,230)" : "rgb(80,80,80)" ]]]'
            - border-radius: 10px
    m:
      card:
        type: custom:button-card
        entity: '[[[ return  variables.水暖毯 ]]]'
        show_icon: true
        show_name: false
        show_state: false
        icon: 'mdi:minus'
        styles:
          card:
            - margin-top: -75px
            - width: 50px
            - height: 50px
            - border-radius: 25px
            - border: '[[[ return variables.主题 =="on" ? "2px solid rgb(150,150,150)" : "2px solid rgb(180,180,180)" ]]]'
            - margin-left: '27px'
            - --mdc-ripple-color: white
            - --mdc-ripple-press-opacity: 0.3
            - background: rgb(0,0,0,0)
          icon:
            - width: 25px
            - height: 25px
            - color: '[[[ return variables.主题 =="on" ? "rgb(150,150,150)" : "rgb(180,180,180)"; ]]]'
        tap_action:
          action: call-service
          service: climate.set_temperature
          data:
            temperature: '[[[ return states[variables.水暖毯].attributes.temperature-1 ]]]'
          target:
            entity_id: '[[[ return  variables.水暖毯 ]]]'
    p:
      card:
        type: custom:button-card
        entity: '[[[ return  variables.水暖毯 ]]]'
        show_icon: true
        show_name: false
        show_state: false
        icon: 'mdi:plus'
        styles:
          card:
            - margin-top: -75px
            - width: 50px
            - height: 50px
            - border-radius: 25px
            - border: '[[[ return variables.主题 =="on" ? "2px solid rgb(150,150,150)" : "2px solid rgb(180,180,180)" ]]]'
            - margin-left: '12px'
            - --mdc-ripple-color: white
            - --mdc-ripple-press-opacity: 0.3 
            - background: rgb(0,0,0,0)
          icon:
            - width: 25px
            - height: 25px
            - color: '[[[ return variables.主题 =="on" ? "rgb(150,150,150)" : "rgb(180,180,180)"; ]]]'
        tap_action:
          action: call-service
          service: climate.set_temperature
          data:
            temperature: '[[[ return states[variables.水暖毯].attributes.temperature-(-1) ]]]'
          target:
            entity_id: '[[[ return  variables.水暖毯 ]]]'
    a1:
      card:
        type: custom:button-card
        show_icon: true
        icon: mdi:fire
        styles:
          card:
            - margin-top: 40px
            - width: 132px
            - height: 42px 
            - border-radius: 10px
            - border-width: 0
            - background: |
                [[[ 
                    var state = states[variables.水暖毯].state;
                    if(state=='heat' ) return "rgb(255,69,0)";
                    return "rgb(0,0,0,0)";
                ]]]
          icon:
            - width: 20px
            - height: 20px
            - color: '[[[ return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)" ]]]'
        tap_action:
          action: call-service
          service: climate.set_hvac_mode
          data:
            hvac_mode: heat
          target:
            entity_id: '[[[ return  variables.水暖毯 ]]]'
    a2:
      card:
        type: custom:button-card
        show_icon: true
        icon: mdi:power
        styles:
          card:
            - margin-top: 40px
            - width: 132px
            - height: 42px 
            - border-radius: 10px
            - border-width: 0
            - background: |
                [[[
                    var state = states[variables.水暖毯].state;
                    if(state=='heat' ) return "rgb(0,0,0,0)";
                    return variables.主题 =="on" ? "rgb(180,180,180)" : "rgb(150,150,150)"
                ]]]
          icon:
            - width: 20px
            - height: 20px
            - color: '[[[ return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)" ]]]'
        tap_action:
          action: call-service
          service: climate.set_hvac_mode
          data:
            hvac_mode: "off"
          target:
            entity_id: '[[[ return  variables.水暖毯 ]]]'
    a3:
      card:
        type: custom:button-card
        show_icon: true
        show_label: true
        label: 普通
        icon: mdi:radiator-disabled
        styles:
          card:
            - margin-top: 150px
            - width: 132px
            - height: 42px 
            - border-radius: 10px
            - border-width: 0
            - background: |
                [[[
                    var state = states[variables.水暖毯].state;
                    var mode = states[variables.水暖毯].attributes.preset_mode;
                    if(state=='heat' && mode=='普通') return 'rgb(255,69,0)';
                    if(state=='off' && mode=='普通' ) return variables.主题 =="on" ? "rgb(180,180,180)" : "rgb(150,150,150)"
                    return "rgb(0,0,0,0)"
                ]]]
          icon:
            - width: 20px
            - height: 20px
            - color: '[[[ return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)" ]]]'
          label:
            - color: '[[[ return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)" ]]]'
            - font-size: 11px
        tap_action:
          action: call-service
          service: climate.set_preset_mode
          data:
            preset_mode: 普通
          target:
            entity_id: '[[[ return  variables.水暖毯 ]]]'
    a4:
      card:
        type: custom:button-card
        show_icon: true
        show_label: true
        label: 除螨
        icon: mdi:radiator
        styles:
          card:
            - margin-top: 150px
            - width: 132px
            - height: 42px 
            - border-radius: 10px
            - border-width: 0
            - background: |
                [[[
                    var state = states[variables.水暖毯].state;
                    var mode = states[variables.水暖毯].attributes.preset_mode;
                    if(state=='heat' && mode=='除螨') return 'rgb(255,69,0)';
                    if(state=='off' && mode=='除螨' ) return variables.主题 =="on" ? "rgb(180,180,180)" : "rgb(150,150,150)"
                    else return "rgb(0,0,0,0)"
                ]]]
          icon:
            - width: 20px
            - height: 20px
            - color: '[[[ return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)" ]]]' 
          label:
            - color: '[[[ return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)" ]]]'
            - font-size: 11px
        tap_action:
          action: call-service
          service: climate.set_preset_mode
          data:
            preset_mode: 除螨
          target:
            entity_id: '[[[ return  variables.水暖毯 ]]]'
    mo:
      card:
        type: custom:button-card
        styles:
          grid:
            - grid-template-areas: |
                'b1' 'b2' 'b3' 'b4' 'b5' 'b6' 'b7'
            - grid-template-columns: 60px
            - grid-template-rows: 0px 0px 0px 0px 0px 0px 0px
          card:
            - padding: 0
            - margin-top: 115px
            - width: 60px
            - height: 455px
            - border-radius: 15px
            - border-width: 0
            - background: '[[[ return variables.主题 =="on" ? "rgb(255,255,255)" : "rgb(50,50,50)" ]]]'
        custom_fields:
          b1:
            card:
              type: custom:button-card
              icon: |
                [[[ 
                    if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                    var antifreeze =states[variables.防冻].state;
                    if(antifreeze=='on' ) return "mdi:snowflake";
                    if(antifreeze=='off') return "mdi:snowflake-off";
                ]]]
              show_icon: true
              show_label: true
              label: 防冻
              styles: 
                card:
                  - margin-top: 170px
                  - margin-left: 8px
                  - border-radius: 10px
                  - width: 42px
                  - height: 42px 
                  - border-width: 0
                  - background: '[[[ return variables.主题 =="on" ? "rgb(230,230,230)" : "rgb(80,80,80)" ]]]'     
                label:
                  - font-size: 11px
                  - color: '[[[ return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)" ]]]'
                icon:
                  - color: | 
                      [[[
                          if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                          var antifreeze =states[variables.防冻].state;
                          if(antifreeze=='on' ) return "rgb(255,69,0)";
                          return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)"
                      ]]]
              tap_action:
                action: call-service
                service: switch.toggle
                data: {}
                target:
                  entity_id: |
                    [[[ 
                        if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                        return  variables.防冻 
                    ]]]
          b2:
            card:
              type: custom:button-card
              icon: |
                [[[ 
                    if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                    var antiscald =states[variables.防烫伤].state;
                    if(antiscald=='on' ) return "mdi:fire";
                    if(antiscald=='off') return "mdi:fire-off";
                ]]]
              show_icon: true
              show_label: true
              label: 防烫伤
              styles: 
                card:
                  - margin-top: 280px
                  - margin-left: 8px
                  - border-radius: 10px
                  - width: 42px
                  - height: 42px
                  - border-width: 0
                  - background: '[[[ return variables.主题 =="on" ? "rgb(230,230,230)" : "rgb(80,80,80)" ]]]'     
                label:
                  - font-size: 11px
                  - color: '[[[ return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)" ]]]'
                icon:
                  - color: | 
                      [[[
                          if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                          var antiscald =states[variables.防烫伤].state;
                          if(antiscald=='on' ) return "rgb(255,69,0)";
                          return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)"
                      ]]]
              tap_action:
                action: call-service
                service: switch.toggle
                data: {}
                target:
                  entity_id: |
                    [[[ 
                        if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                        return  variables.防烫伤 
                    ]]]
          b3:
            card:
              type: custom:button-card
              icon: |
                [[[ 
                    if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                    var sleep =states[variables.睡眠].state;
                    if(sleep=='on' ) return "mdi:sleep";
                    if(sleep=='off') return "mdi:sleep-off";
                ]]]
              show_icon: true
              show_label: true
              label: 睡眠
              styles: 
                card:
                  - margin-top: 390px
                  - margin-left: 8px
                  - border-radius: 10px
                  - width: 42px
                  - height: 42px
                  - border-width: 0
                  - background: '[[[ return variables.主题 =="on" ? "rgb(230,230,230)" : "rgb(80,80,80)" ]]]'     
                label:
                  - font-size: 11px
                  - color: '[[[ return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)" ]]]'
                icon:
                  - color: | 
                      [[[
                          if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                          var sleep =states[variables.睡眠].state;
                          if(sleep=='on' ) return "rgb(255,69,0)";
                          return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)"
                      ]]]
              tap_action:
                action: call-service
                service: switch.toggle
                data: {}
                target:
                  entity_id: |
                    [[[ 
                        if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                        return  variables.睡眠 
                    ]]]  
          b4:
            card:
              type: custom:button-card
              icon: |
                [[[ 
                    if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                    var light =states[variables.指示灯].state;
                    if(light=='on' ) return "mdi:lightbulb-on";
                    if(light=='off') return "mdi:lightbulb-off";
                ]]]
              show_icon: true
              show_label: true
              label: 指示灯
              styles: 
                card:
                  - margin-top: 500px
                  - margin-left: 8px
                  - border-radius: 10px
                  - width: 42px
                  - height: 42px
                  - border-width: 0
                  - background: '[[[ return variables.主题 =="on" ? "rgb(230,230,230)" : "rgb(80,80,80)" ]]]'     
                label:
                  - font-size: 11px
                  - color: '[[[ return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)" ]]]'
                icon:
                  - color: | 
                      [[[
                          if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                          var light =states[variables.指示灯].state;
                          if(light=='on' ) return "rgb(255,69,0)";
                          return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)"
                      ]]]
              tap_action:
                action: call-service
                service: light.toggle
                data: {} 
                target:
                  entity_id: |
                    [[[ 
                        if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                        return  variables.指示灯 
                    ]]]
          b5:
            card:
              type: custom:button-card
              icon: |
                [[[ 
                    if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                    var alarm =states[variables.提示音].state;
                    if(alarm=='on' ) return "mdi:volume-high";
                    if(alarm=='off') return "mdi:volume-mute";
                ]]]
              show_icon: true
              show_label: true
              label: 提示音
              styles: 
                card:
                  - margin-top: 610px
                  - margin-left: 8px
                  - border-radius: 10px
                  - width: 42px
                  - height: 42px
                  - border-width: 0
                  - background: '[[[ return variables.主题 =="on" ? "rgb(230,230,230)" : "rgb(80,80,80)" ]]]'     
                label:
                  - font-size: 11px
                  - color: '[[[ return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)" ]]]'
                icon:
                  - color: | 
                      [[[
                          if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                          var alarm =states[variables.提示音].state;
                          if(alarm=='on' ) return "rgb(255,69,0)";
                          return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)"
                      ]]]
              tap_action:
                action: call-service
                service: switch.toggle
                data: {}
                target:
                  entity_id: |
                    [[[ 
                        if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                        return  variables.提示音 
                    ]]]
          b6:
            card:
              type: custom:button-card
              icon: |
                [[[ 
                    if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                    var locked =states[variables.按键锁].state;
                    if(locked=='on' ) return "mdi:lock-open";
                    if(locked=='off') return "mdi:lock-open-variant";
                ]]]
              show_icon: true
              show_label: true
              label: 按键锁
              styles:
                card:
                  - margin-top: 720px
                  - margin-left: 8px
                  - border-radius: 10px
                  - width: 42px
                  - height: 42px
                  - border-width: 0
                  - background: '[[[ return variables.主题 =="on" ? "rgb(230,230,230)" : "rgb(80,80,80)" ]]]'     
                label:
                  - font-size: 11px
                  - color: '[[[ return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)" ]]]'
                icon: 
                  - color: |
                      [[[
                          if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                          var locked =states[variables.按键锁].state;
                          if(locked=='on' ) return "rgb(255,69,0)";
                          return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)"
                      ]]]
              tap_action:
                action: call-service
                service: switch.toggle
                data: {}
                target:
                  entity_id: |
                    [[[ 
                        if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                        return  variables.按键锁 
                    ]]]
          b7:
            card:
              type: custom:button-card
              show_label: true
              label: |
                [[[
                    if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                    return states[variables.水位提示].state+"<br>"+"水位";
                ]]]
              styles:
                card:
                  - margin-top: 830px
                  - margin-left: 8px
                  - border-radius: 10px
                  - width: 42px
                  - height: 42px
                  - border-width: 0
                  - background:  '[[[ return variables.主题 =="on" ? "rgb(230,230,230)" : "rgb(80,80,80)" ]]]'     
                label:
                  - font-size: 11px
                  - color: |
                      [[[
                          if (variables.附加信息=='左侧' || variables.附加信息=='右侧')
                          var water =states[variables.水位提示].state;
                          if( water == '缺水') return "rgb(255,0,0)";
                          if( water == '低' ) return "rgb(255,100,0)";
                          return variables.主题 =="on" ? "rgb(0,0,0)" : "rgb(255,255,255)"
                      ]]] 